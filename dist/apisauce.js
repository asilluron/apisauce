import _partial from"ramda/src/partial";import _curry from"ramda/src/curry";import _pipe from"ramda/src/pipe";import _keys from"ramda/src/keys";import _forEach from"ramda/src/forEach";import _dissoc from"ramda/src/dissoc";import _merge from"ramda/src/merge";import _prop from"ramda/src/prop";import _always from"ramda/src/always";import _ifElse from"ramda/src/ifElse";import _contains from"ramda/src/contains";import _gte from"ramda/src/gte";import _curryN from"ramda/src/curryN";import _T from"ramda/src/T";import _is from"ramda/src/is";import _identity from"ramda/src/identity";import _isNil from"ramda/src/isNil";import _cond from"ramda/src/cond";import axios from"axios";var __assign=function(){return(__assign=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var a in e=arguments[t])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)},__awaiter=function(r,e,t,n){return new(t||(t=Promise))(function(a,o){function i(r){try{R(n.next(r))}catch(r){o(r)}}function s(r){try{R(n.throw(r))}catch(r){o(r)}}function R(r){r.done?a(r.value):new t(function(e){e(r.value)}).then(i,s)}R((n=n.apply(r,e||[])).next())})},__generator=function(r,e){var t,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(r,i)}catch(r){o=[6,r],n=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_this=void 0,toNumber=_cond([[_isNil,_identity],[_is(Number),_identity],[_T,function(r){return Number(r)}]]),isWithin=_curryN(3,function(r,e,t){var n=_is(Number);return n(r)&&n(e)&&n(t)&&_gte(t,r)&&_gte(e,t)}),containsText=_curryN(2,function(r,e){return _contains(e,r)}),isPromise=function(r){return!!r&&("object"==typeof r||"function"==typeof r)&&"function"==typeof r.then},DEFAULT_HEADERS={Accept:"application/json","Content-Type":"application/json"},DEFAULT_CONFIG={timeout:0},NONE=null,CLIENT_ERROR="CLIENT_ERROR",SERVER_ERROR="SERVER_ERROR",TIMEOUT_ERROR="TIMEOUT_ERROR",CONNECTION_ERROR="CONNECTION_ERROR",NETWORK_ERROR="NETWORK_ERROR",UNKNOWN_ERROR="UNKNOWN_ERROR",CANCEL_ERROR="CANCEL_ERROR",TIMEOUT_ERROR_CODES=["ECONNABORTED"],NODEJS_CONNECTION_ERROR_CODES=["ENOTFOUND","ECONNREFUSED","ECONNRESET"],in200s=isWithin(200,299),in400s=isWithin(400,499),in500s=isWithin(500,599),statusNil=_ifElse(_isNil,_always(void 0),_prop("status")),getProblemFromError=function(r){return"Network Error"===r.message?NETWORK_ERROR:axios.isCancel(r)?CANCEL_ERROR:_cond([[_isNil,function(){return getProblemFromStatus(statusNil(r.response))}],[containsText(TIMEOUT_ERROR_CODES),_always(TIMEOUT_ERROR)],[containsText(NODEJS_CONNECTION_ERROR_CODES),_always(CONNECTION_ERROR)],[_T,_always(UNKNOWN_ERROR)]])(r.code)},getProblemFromStatus=function(r){return _cond([[_isNil,_always(UNKNOWN_ERROR)],[in200s,_always(NONE)],[in400s,_always(CLIENT_ERROR)],[in500s,_always(SERVER_ERROR)],[_T,_always(UNKNOWN_ERROR)]])(r)},create=function(r){var e=_merge(DEFAULT_HEADERS,r.headers||{}),t=_merge(DEFAULT_CONFIG,_dissoc("headers",r)),n=axios.create(t),a=[],o=[],i=[],s=[],R=function(r,t){return e[r]=t,n},c=function(r,e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),E(_merge({url:e,params:t,method:r},n))},u=function(r,e,t,n){return void 0===t&&(t=null),void 0===n&&(n={}),E(_merge({url:e,method:r,data:t},n))},E=function(r){return __awaiter(_this,void 0,void 0,function(){var t,a,s;return __generator(this,function(R){switch(R.label){case 0:if(r.headers=__assign({},e,r.headers),o.length>0&&_forEach(function(e){return e(r)},o),!(i.length>0))return[3,6];t=0,R.label=1;case 1:return t<i.length?(a=i[t](r),isPromise(a)?[4,a]:[3,3]):[3,6];case 2:return R.sent(),[3,5];case 3:return[4,a(r)];case 4:R.sent(),R.label=5;case 5:return t++,[3,1];case 6:return s=_pipe(l(toNumber(new Date)),_),[2,n.request(r).then(s).catch(s)]}})})},_=function(r){return a.forEach(function(e){try{e(r)}catch(r){}}),r},l=_curry(function(r,e){var t=toNumber(new Date)-r,n=e instanceof Error||axios.isCancel(e),a=e,o=e,i=n?o.response:a,R=i&&i.status||null,c=n?getProblemFromError(e):getProblemFromStatus(R),u=n?o:null,E=in200s(R),_=e.config||null,l={duration:t,problem:c,originalError:u,ok:E,status:R,headers:i&&i.headers||null,config:_,data:i&&i.data||null};return s.length>0&&_forEach(function(r){return r(l)},s),l});return{axiosInstance:n,monitors:a,addMonitor:function(r){a.push(r)},requestTransforms:o,asyncRequestTransforms:i,responseTransforms:s,addRequestTransform:function(r){return o.push(r)},addAsyncRequestTransform:function(r){return i.push(r)},addResponseTransform:function(r){return s.push(r)},setHeader:R,setHeaders:function(r){return _forEach(function(e){return R(e,r[e])},_keys(r)),n},deleteHeader:function(r){return delete e[r],n},headers:e,setBaseURL:function(r){return n.defaults.baseURL=r,n},getBaseURL:function(){return n.defaults.baseURL},get:_partial(c,["get"]),delete:_partial(c,["delete"]),head:_partial(c,["head"]),post:_partial(u,["post"]),put:_partial(u,["put"]),patch:_partial(u,["patch"]),link:_partial(c,["link"]),unlink:_partial(c,["unlink"])}},isCancel=axios.isCancel,CancelToken=axios.CancelToken,apisauce={DEFAULT_HEADERS:DEFAULT_HEADERS,NONE:NONE,CLIENT_ERROR:CLIENT_ERROR,SERVER_ERROR:SERVER_ERROR,TIMEOUT_ERROR:TIMEOUT_ERROR,CONNECTION_ERROR:CONNECTION_ERROR,NETWORK_ERROR:NETWORK_ERROR,UNKNOWN_ERROR:UNKNOWN_ERROR,create:create,isCancel:isCancel,CancelToken:CancelToken};export default apisauce;export{DEFAULT_HEADERS,NONE,CLIENT_ERROR,SERVER_ERROR,TIMEOUT_ERROR,CONNECTION_ERROR,NETWORK_ERROR,UNKNOWN_ERROR,CANCEL_ERROR,getProblemFromError,getProblemFromStatus,create,isCancel,CancelToken};
