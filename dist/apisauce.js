import axios from"axios";import{cond,isNil,identity,is,T,curry,curryN,gte,ifElse,prop,merge,dissoc,keys,forEach,pipe,partial,contains,always}from"ramda";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__awaiter=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{R(r.next(e))}catch(e){o(e)}}function s(e){try{R(r.throw(e))}catch(e){o(e)}}function R(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,s)}R((r=r.apply(e,t||[])).next())})},__generator=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_this=void 0,toNumber=cond([[isNil,identity],[is(Number),identity],[T,function(e){return Number(e)}]]),isWithin=curryN(3,function(e,t,n){var r=is(Number);return r(e)&&r(t)&&r(n)&&gte(n,e)&&gte(t,n)}),containsText=curryN(2,function(e,t){return contains(t,e)}),isPromise=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then},DEFAULT_HEADERS={Accept:"application/json","Content-Type":"application/json"},DEFAULT_CONFIG={timeout:0},NONE=null,CLIENT_ERROR="CLIENT_ERROR",SERVER_ERROR="SERVER_ERROR",TIMEOUT_ERROR="TIMEOUT_ERROR",CONNECTION_ERROR="CONNECTION_ERROR",NETWORK_ERROR="NETWORK_ERROR",UNKNOWN_ERROR="UNKNOWN_ERROR",CANCEL_ERROR="CANCEL_ERROR",TIMEOUT_ERROR_CODES=["ECONNABORTED"],NODEJS_CONNECTION_ERROR_CODES=["ENOTFOUND","ECONNREFUSED","ECONNRESET"],in200s=isWithin(200,299),in400s=isWithin(400,499),in500s=isWithin(500,599),statusNil=ifElse(isNil,always(void 0),prop("status")),getProblemFromError=function(e){return"Network Error"===e.message?NETWORK_ERROR:axios.isCancel(e)?CANCEL_ERROR:cond([[isNil,function(){return getProblemFromStatus(statusNil(e.response))}],[containsText(TIMEOUT_ERROR_CODES),always(TIMEOUT_ERROR)],[containsText(NODEJS_CONNECTION_ERROR_CODES),always(CONNECTION_ERROR)],[T,always(UNKNOWN_ERROR)]])(e.code)},getProblemFromStatus=function(e){return cond([[isNil,always(UNKNOWN_ERROR)],[in200s,always(NONE)],[in400s,always(CLIENT_ERROR)],[in500s,always(SERVER_ERROR)],[T,always(UNKNOWN_ERROR)]])(e)},create=function(e){var t=merge(DEFAULT_HEADERS,e.headers||{}),n=merge(DEFAULT_CONFIG,dissoc("headers",e)),r=axios.create(n),a=[],o=[],i=[],s=[],R=function(e,n){return t[e]=n,r},u=function(e,t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),c(merge({url:t,params:n,method:e},r))},E=function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r={}),c(merge({url:t,method:e,data:n},r))},c=function(e){return __awaiter(_this,void 0,void 0,function(){var n,a,s;return __generator(this,function(R){switch(R.label){case 0:if(e.headers=__assign({},t,e.headers),o.length>0&&forEach(function(t){return t(e)},o),!(i.length>0))return[3,6];n=0,R.label=1;case 1:return n<i.length?(a=i[n](e),isPromise(a)?[4,a]:[3,3]):[3,6];case 2:return R.sent(),[3,5];case 3:return[4,a(e)];case 4:R.sent(),R.label=5;case 5:return n++,[3,1];case 6:return s=pipe(O(toNumber(new Date)),l),[2,r.request(e).then(s).catch(s)]}})})},l=function(e){return a.forEach(function(t){try{t(e)}catch(e){}}),e},O=curry(function(e,t){var n=toNumber(new Date)-e,r=t instanceof Error||axios.isCancel(t),a=t,o=t,i=r?o.response:a,R=i&&i.status||null,u=r?getProblemFromError(t):getProblemFromStatus(R),E=r?o:null,c=in200s(R),l=t.config||null,O={duration:n,problem:u,originalError:E,ok:c,status:R,headers:i&&i.headers||null,config:l,data:i&&i.data||null};return s.length>0&&forEach(function(e){return e(O)},s),O});return{axiosInstance:r,monitors:a,addMonitor:function(e){a.push(e)},requestTransforms:o,asyncRequestTransforms:i,responseTransforms:s,addRequestTransform:function(e){return o.push(e)},addAsyncRequestTransform:function(e){return i.push(e)},addResponseTransform:function(e){return s.push(e)},setHeader:R,setHeaders:function(e){return forEach(function(t){return R(t,e[t])},keys(e)),r},deleteHeader:function(e){return delete t[e],r},headers:t,setBaseURL:function(e){return r.defaults.baseURL=e,r},getBaseURL:function(){return r.defaults.baseURL},get:partial(u,["get"]),delete:partial(u,["delete"]),head:partial(u,["head"]),post:partial(E,["post"]),put:partial(E,["put"]),patch:partial(E,["patch"]),link:partial(u,["link"]),unlink:partial(u,["unlink"])}},isCancel=axios.isCancel,CancelToken=axios.CancelToken,apisauce={DEFAULT_HEADERS:DEFAULT_HEADERS,NONE:NONE,CLIENT_ERROR:CLIENT_ERROR,SERVER_ERROR:SERVER_ERROR,TIMEOUT_ERROR:TIMEOUT_ERROR,CONNECTION_ERROR:CONNECTION_ERROR,NETWORK_ERROR:NETWORK_ERROR,UNKNOWN_ERROR:UNKNOWN_ERROR,create:create,isCancel:isCancel,CancelToken:CancelToken};export default apisauce;export{DEFAULT_HEADERS,NONE,CLIENT_ERROR,SERVER_ERROR,TIMEOUT_ERROR,CONNECTION_ERROR,NETWORK_ERROR,UNKNOWN_ERROR,CANCEL_ERROR,getProblemFromError,getProblemFromStatus,create,isCancel,CancelToken};
